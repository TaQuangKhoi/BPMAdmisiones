{
  "modelVersion" : "2.3",
  "previousArtifactVersion" : "2.2",
  "id" : "LoginLayout",
  "name" : "LoginLayout",
  "lastUpdate" : 1679842891451,
  "rows" : [
    [
      {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 12,
          "lg" : 12
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : "layout-header hidden1 positioned"
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "d865a0db-76a5-4bd0-b707-048aab1b7fd1",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : "remove-padding-and-margin hidden1"
                },
                "hidden" : {
                  "type" : "expression",
                  "value" : "!application"
                },
                "targetUrl" : {
                  "type" : "variable",
                  "value" : "targetedPageUrl"
                },
                "userName" : {
                  "type" : "expression",
                  "value" : "userName"
                },
                "currentSessionModalId" : {
                  "type" : "interpolation",
                  "value" : "currentSessionModalId"
                },
                "appSelectionModalId" : {
                  "type" : "constant",
                  "value" : "appSelectionModalId"
                },
                "application" : {
                  "type" : "expression",
                  "value" : "application[0] || {}"
                },
                "pageToken" : {
                  "type" : "expression",
                  "value" : "pageToken"
                },
                "userId" : {
                  "type" : "expression",
                  "value" : "loggedUser.id"
                },
                "homePageToken" : {
                  "type" : "expression",
                  "value" : "homePage.token"
                },
                "isGuestUser" : {
                  "type" : "expression",
                  "value" : "isGuestUser"
                },
                "logoutURL" : {
                  "type" : "interpolation",
                  "value" : "{{logoutURL}}"
                },
                "successfulLogoutResponse" : {
                  "type" : "variable",
                  "value" : "logoutSuccessAndLogin"
                }
              },
              "reference" : "a4a02132-16c7-4812-b19d-c3e3d71c1a12",
              "hasValidationError" : false,
              "id" : "customLayoutMenuBonitaV3"
            }
          ]
        ]
      }
    ],
    [
      {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 12,
          "lg" : 12
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : "layout-content"
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "1a39467b-3ef1-4dd7-be74-e4f3c81e7eb4",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : "remove-padding-and-margin living-application-iframe"
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "src" : {
                  "type" : "variable",
                  "value" : "targetedPageUrl"
                }
              },
              "reference" : "d82ee36b-2feb-45b4-a75f-aa220d67b980",
              "hasValidationError" : false,
              "id" : "customLivingApplicationIFrameV4"
            }
          ]
        ]
      }
    ],
    [
      {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 12,
          "lg" : 12
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : "layout-footer remove-padding-and-margin"
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "62b6cc6e-6925-4310-9dc9-6b1ce440b13d",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [
          [ ]
        ]
      }
    ]
  ],
  "assets" : [
    {
      "id" : "856024bd-93a7-4880-80ad-c35274353601",
      "name" : "user-circle.css",
      "type" : "css",
      "order" : 7,
      "external" : false
    },
    {
      "id" : "b6ac73e1-9f7e-4c4a-9856-358140b56ca5",
      "name" : "layout.css",
      "type" : "css",
      "order" : 6,
      "external" : false
    },
    {
      "id" : "23b7d7dd-cb08-4f28-aab2-e28b16cbed62",
      "name" : "fa-solid-900.woff",
      "type" : "img",
      "order" : 9,
      "external" : false
    },
    {
      "id" : "346a853d-6737-4422-bfae-c8acf7476ca4",
      "name" : "style.css",
      "type" : "css",
      "order" : 5,
      "external" : false
    },
    {
      "id" : "3c2b8e1c-5de4-4eb4-8495-da7fa250c117",
      "name" : "localization.json",
      "type" : "json",
      "order" : 4,
      "external" : false
    },
    {
      "id" : "eb2b632f-0def-480c-b90c-98291b0fca75",
      "name" : "layout.js",
      "type" : "js",
      "order" : 3,
      "external" : false
    },
    {
      "id" : "cdb9b2e6-b75d-4dc8-b521-84b87f7b822f",
      "name" : "fa-solid-900.woff2",
      "type" : "img",
      "order" : 8,
      "external" : false
    }
  ],
  "inactiveAssets" : [ ],
  "variables" : {
    "profilePlaceholder" : {
      "type" : "expression",
      "value" : [
        "if ($data.currentUserProfileList && $data.currentUserProfileList.length <= 1) {",
        "    return $data.currentUserProfileList[0].name;",
        "}",
        "",
        "return \"All profiles\";"
      ],
      "exposed" : false
    },
    "targetedPageUrl" : {
      "type" : "constant",
      "exposed" : false
    },
    "selectedLanguage" : {
      "type" : "constant",
      "value" : [
        ""
      ],
      "exposed" : false
    },
    "applicationContainerClasses" : {
      "type" : "expression",
      "value" : [
        "return function (currentApp){",
        "    var cssClasses = \"app-item \";",
        "    ",
        "    if(currentApp.token === $data.appToken){",
        "        cssClasses += \"app-item--current\";",
        "    }",
        "    ",
        "    return cssClasses;",
        "};"
      ],
      "exposed" : false
    },
    "eventList" : {
      "type" : "json",
      "value" : [
        "{\"actions\":[]}"
      ],
      "exposed" : false
    },
    "session" : {
      "type" : "url",
      "value" : [
        "../API/system/session/unusedId"
      ],
      "exposed" : false
    },
    "loggedUser" : {
      "type" : "url",
      "value" : [
        "../API/identity/user/{{session.user_id}}?d=professional_data"
      ],
      "exposed" : false
    },
    "homePage" : {
      "type" : "url",
      "value" : [
        "../API/living/application-page/{{application[0].homePageId}}"
      ],
      "exposed" : false
    },
    "userIconHtmlContent" : {
      "type" : "expression",
      "value" : [
        "if (!$data.loggedUser) {",
        "    return '';",
        "}",
        "",
        "var isCustomIconPath = $data.loggedUser.icon && $data.loggedUser.icon!='icons/default/icon_user.png';",
        "",
        "const htmlContentForImage = `<span><img title=\"${$data.userName}\" src=\"${$data.loggedUser.icon}\" alt=\"${uiTranslate('User icon')}\"></span>`;",
        "",
        "const htmlContentForDefaultIcon = `<i title=\"${$data.userName}\" class=\"fa fa-user-circle\"></i>`;",
        "",
        "return isCustomIconPath ? htmlContentForImage : htmlContentForDefaultIcon;"
      ],
      "exposed" : false
    },
    "currentText" : {
      "type" : "expression",
      "value" : [
        "return \"app-item-current--text\";"
      ],
      "exposed" : false
    },
    "setWindowAppName" : {
      "type" : "expression",
      "value" : [
        "if ($data.appName) {",
        "    window.document.title = $data.appName;",
        "}"
      ],
      "exposed" : false
    },
    "appsList" : {
      "type" : "url",
      "value" : [
        "../API/living/application?c=9999{{queryParamSearchFilter}}{{queryParamProfileFilter}}"
      ],
      "exposed" : false
    },
    "currentUserProfileList" : {
      "type" : "url",
      "value" : [
        "../API/portal/profile?p=0&c=100&f=user_id={{loggedUser.id}}"
      ],
      "exposed" : false
    },
    "languageList" : {
      "type" : "url",
      "value" : [
        "../API/system/i18nlocale?p=0&c=0"
      ],
      "exposed" : false
    },
    "authorizedAppsList" : {
      "type" : "expression",
      "value" : [
        "if (!$data.currentUserProfileList || !$data.appsList) {",
        "    return [];",
        "}",
        "",
        "function isAppAuthorized(application) {",
        "    return $data.currentUserProfileList.map((profile) => profile.id).includes(application.profileId);",
        "}",
        "",
        "return $data.appsList.filter(application => isAppAuthorized(application));"
      ],
      "exposed" : false
    },
    "queryParamProfileFilter" : {
      "type" : "expression",
      "value" : [
        "if(!$data.selectedProfile) {",
        "    return \"\";",
        "}",
        "return \"&f=profileId=\"+$data.selectedProfile;"
      ],
      "exposed" : false
    },
    "pathArray" : {
      "type" : "expression",
      "value" : [
        "return window.location.pathname.split( '/' );"
      ],
      "exposed" : false
    },
    "appName" : {
      "type" : "expression",
      "value" : [
        "if (!$data.application || !$data.application[0]) {",
        "    return \"\";",
        "}",
        "return $data.application[0].displayName;"
      ],
      "exposed" : false
    },
    "appToken" : {
      "type" : "expression",
      "value" : [
        "return  $data.pathArray[$data.pathArray.length-3];"
      ],
      "exposed" : false
    },
    "appsListGroupByThree" : {
      "type" : "expression",
      "value" : [
        "if (!$data.appsList || !$data.currentUserProfileList) {",
        "    return [];",
        "}",
        "",
        "var i = 0;",
        "var result = [];",
        "while (i < $data.authorizedAppsList.length) {",
        "    if (i%3 === 0) {",
        "        result.push([]);",
        "    }",
        "    result[Math.floor(i/3)].push($data.authorizedAppsList[i]);",
        "    i++;",
        "}",
        "",
        "return result;"
      ],
      "exposed" : false
    },
    "windowReload" : {
      "type" : "expression",
      "value" : [
        "if ($data.logoutSuccess) {",
        "    window.location.reload();",
        "}"
      ],
      "exposed" : false
    },
    "userName" : {
      "type" : "expression",
      "value" : [
        "if ($data.loggedUser && $data.loggedUser.firstname && $data.loggedUser.lastname) {",
        "    return $data.loggedUser.firstname + \" \" + $data.loggedUser.lastname;",
        "} else {",
        "    return $data.session.user_name;",
        "}"
      ],
      "exposed" : false
    },
    "selectedProfile" : {
      "type" : "constant",
      "exposed" : false
    },
    "storageLanguage" : {
      "type" : "expression",
      "value" : [
        "function getCookie(name) {",
        "    if (document.cookie) {",
        "        var value = \"; \" + document.cookie;",
        "        var parts = value.split(\"; \" + name + \"=\");",
        "        if (parts.length == 2) return parts.pop().split(\";\").shift();",
        "    }",
        "    return \"\";",
        "}",
        "",
        "return getCookie(\"BOS_Locale\");"
      ],
      "exposed" : false
    },
    "profileDropdownOptions" : {
      "type" : "expression",
      "value" : [
        "return [{\"name\": uiTranslate(\"All profiles\")}].concat($data.currentUserProfileList);"
      ],
      "exposed" : false
    },
    "queryParamSearchFilter" : {
      "type" : "expression",
      "value" : [
        "if(!$data.searchFilterValue) {",
        "    return \"\";",
        "}",
        "return \"&s=\"+$data.searchFilterValue;"
      ],
      "exposed" : false
    },
    "application" : {
      "type" : "url",
      "value" : [
        "../API/living/application/?c=1&f=token%3D{{appToken}}"
      ],
      "exposed" : false
    },
    "logoutHidden" : {
      "type" : "expression",
      "value" : [
        "return JSON.parse($data.session.conf).indexOf('logout.link.hidden') !== -1;"
      ],
      "exposed" : false
    },
    "setLocal" : {
      "type" : "expression",
      "value" : [
        "if($data.eventList.actions && $data.eventList.actions.length > 0){",
        "    var action=$data.eventList.actions[0];",
        "    if(action===\"locale\"){",
        "        document.cookie=\"BOS_Locale=\"+$data.selectedLanguage.locale+\";path=/\";;",
        "        document.location.reload();",
        "    }",
        "}"
      ],
      "exposed" : false
    },
    "pageToken" : {
      "type" : "expression",
      "value" : [
        "return $data.pathArray[$data.pathArray.length-2];"
      ],
      "exposed" : false
    },
    "searchFilterValue" : {
      "type" : "constant",
      "exposed" : false
    },
    "logoutSuccess" : {
      "type" : "constant",
      "exposed" : false
    },
    "isGuestUser" : {
      "type" : "expression",
      "value" : [
        "return $data.session.is_guest_user === 'true';"
      ],
      "exposed" : false
    },
    "logoutSuccessAndLogin" : {
      "type" : "constant",
      "exposed" : false
    },
    "displayLoginPage" : {
      "type" : "expression",
      "value" : [
        "if ($data.logoutSuccessAndLogin) {",
        "    let location = window.location.pathname + '?' + window.location.search;",
        "    window.location.assign('../../../login.jsp?redirectUrl=' + encodeURIComponent(location));",
        "}"
      ],
      "exposed" : false
    },
    "logoutURL" : {
      "type" : "constant",
      "value" : [
        "../../../logoutservice"
      ],
      "exposed" : false
    },
    "resetCurrentLanguage" : {
      "type" : "expression",
      "value" : [
        "return function() {",
        "    if ($data.storageLanguage) {",
        "        var languageName = \"\";",
        "        switch($data.storageLanguage) {",
        "            case \"en\":",
        "                languageName = \"English\";",
        "                break;",
        "            case \"fr\":",
        "                languageName = \"Français\";",
        "                break;",
        "            case \"es\":",
        "                languageName = \"Español\";",
        "                break;",
        "            case \"pt_BR\":",
        "                languageName = \"Português (Brasil)\";",
        "                break;",
        "            case \"ja\":",
        "                languageName = \"日本語\";",
        "                break;",
        "            default:",
        "                $data.selectedLanguage = \"\";",
        "        }",
        "        $data.selectedLanguage = {\"name\": languageName, \"locale\": $data.storageLanguage}; ",
        "    }",
        "",
        "    return \"currentSessionModalId\";",
        "}"
      ],
      "exposed" : false
    }
  },
  "hasValidationError" : false,
  "uuid" : "e73d62fc-4c9d-47d1-bd83-6082a7ba9ce1",
  "type" : "layout",
  "description" : "",
  "displayName" : "LoginLayout"
}